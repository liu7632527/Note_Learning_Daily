# Mysql 47道面试题



## 1.查询姓“猴”的学生名单

student 数据表如下：

| id   | name   | birth      | sex  |
| ---- | ------ | ---------- | ---- |
| 001  | 猴子   | 1989-01-01 | 男   |
| 002  | 猴子   | 1990-12-21 | 女   |
| 003  | 马云   | 1991-12-21 | 男   |
| 004  | 王思聪 | 1990-5-20  | 男   |

```mysql
select *from student where substring(name,1,1)="猴"
```



## 2.查询姓名中最后一个字是“猴”的学生名单

student 数据表如下：

| id   | name   | birth      | sex  |
| ---- | ------ | ---------- | ---- |
| 001  | 猴子   | 1989-01-01 | 男   |
| 002  | 猴子   | 1990-12-21 | 女   |
| 003  | 马云   | 1991-12-21 | 男   |
| 004  | 王思聪 | 1990-5-20  | 男   |

```mysql
select *from student where name like '__猴'
```



## 3.查询姓名中带“猴”的学生名单

student 数据表如下：

| id   | name   | birth      | sex  |
| ---- | ------ | ---------- | ---- |
| 001  | 猴子   | 1989-01-01 | 男   |
| 002  | 猴子   | 1990-12-21 | 女   |
| 003  | 马云   | 1991-12-21 | 男   |
| 004  | 王思聪 | 1990-5-20  | 男   |

```mysql
select *from student where name like'%猴%'
```



## 4.查询姓“孟”老师的个数(字段别名 count_tea)

teacher 数据表如下：

| id   | name   |
| ---- | ------ |
| 0001 | 孟扎扎 |
| 0002 | 马化腾 |
| 0003 | NULL   |
| 0004 |        |

```mysql
select count(name) as count_tea
from teacher 
where substring(name,1,1)="孟" 
group by name
```



## 5.查询课程编号为“0002”的总成绩

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select sum(score) as 'sum(score)'
from score 
where
course_id = "0002"
```



## 6.查询已经选课的学生人数（可能存在一个同学选了多门课）

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select count(DISTINCT student_id) 
from score 
```



## 7.查询各科成绩最高和最低分查询各科成绩最高和最低分, 按课程号分组

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select course_id,max(score),min(score) 
from score 
group by course_id
```



## 8.查询每门课被选修的学生人数(别名 student_num)

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select distinct course_id,count(course_id) as 'student_num' 
from score 
group by course_id
```



## 9.查询男生、女生人数（别名 sex_num）, 并按性别分组

student 数据表如下：

| id   | name   | birth      | sex  |
| ---- | ------ | ---------- | ---- |
| 001  | 猴子   | 1989-01-01 | 男   |
| 002  | 猴子   | 1990-12-21 | 女   |
| 003  | 马云   | 1991-12-21 | 男   |
| 004  | 王思聪 | 1990-5-20  | 男   |

```mysql
select sex,count(sex) as sex_num 
from student 
group by sex
```



## 10.查询平均成绩大于60分学生的学号和平均成绩

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select avg，student_id
from score 
group by student_id 
having avg(score)>60 
```



## 11.查询至少选修两门课程的学生学号

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select count(course_id),student_id 
from score 
group by student_id 
having count(course_id)>=2
```



## 12.查询同名同姓学生名单并统计同名人数

student 数据表如下：

| id   | name   | birth      | sex  |
| ---- | ------ | ---------- | ---- |
| 001  | 猴子   | 1989-01-01 | 男   |
| 002  | 猴子   | 1990-12-21 | 女   |
| 003  | 马云   | 1991-12-21 | 男   |
| 004  | 王思聪 | 1990-5-20  | 男   |

```mysql
select count(name),name 
FROM student 
group by name 
having count(name)>1
```



## 13.查询不及格的课程并按课程号从大到小排列(60分为及格)

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select * 
from score 
where score < '60' 
order by course_id
```



## 14.查询每门课程的平均成绩（别名用 avg_score），结果按平均成绩升序排序，平均成绩相同时，按课程号降序排列

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select course_id,avg(score) as avg_score 
from score 
group by course_id 
order by avg_score ASC, course_id DESC
```



## 15.检索课程编号为“0004”且分数小于60的学生学号，结果按按分数降序排列

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select student_id,score 
from score 
where score < 60 
order by score desc
```



## 16.统计每门课程的学生选修人数(超过2人的课程才统计),要求输出课程号和选修人数(别名用num)，查询结果按人数降序排序，若人数相同，按课程号升序排序

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select DISTINCT course_id,count(student_id) as num 
from score 
GROUP BY course_id 
HAVING COUNT(student_id)>2
ORDER BY num DESC, course_id ASC
```



## 17.查询两门及两门以上不及格课程的同学的学号及其平均成绩(若95分以下为不及格)

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select student_id,avg(score) 
from score
group by student_id
having count(score < 95) >=2
```



## 18.查询学生的总成绩(别名用 sum_score)并进行排名

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select student_id,sum(score) as sum_score 
from score
group by student_id
order by sum_score 
```



## 19.查询平均成绩大于60分的学生的学号和平均成绩（别名用avg_score）, 通过学号分组

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |

```mysql
select student_id,avg(score) as avg_score
from score
group by student_id
having avg_score > 60
```



## 20.查询所有课程成绩小于90分学生的学号、姓名

student 数据表如下

| id   | name   | birth      | sex  |
| ---- | ------ | ---------- | ---- |
| 001  | 猴子   | 1989-01-01 | 男   |
| 002  | 猴子   | 1990-12-21 | 女   |
| 003  | 马云   | 1991-12-21 | 男   |
| 004  | 王思聪 | 1990-5-20  | 男   |

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |



```mysql
select student.id,student.name
from student,score
where student.id=score.student_id
group by student_id
having max(score) <90
```



## 21.查询没有选修所有课的学生的学号、姓名

student 数据表如下

| id   | name   | birth      | sex  |
| ---- | ------ | ---------- | ---- |
| 001  | 猴子   | 1989-01-01 | 男   |
| 002  | 猴子   | 1990-12-21 | 女   |
| 003  | 马云   | 1991-12-21 | 男   |
| 004  | 王思聪 | 1990-5-20  | 男   |

score 数据表如下：

| student_id | course_id | score |
| ---------- | --------- | ----- |
| 0001       | 0001      | 80    |
| 0001       | 0002      | 90    |
| 0001       | 0003      | 99    |
| 0002       | 0002      | 60    |
| 0002       | 0003      | 80    |
| 0003       | 0001      | 80    |
| 0003       | 0002      | 80    |
| 0003       | 0003      | 80    |



```mysql
SELECT student.id, student.name
FROM student 
LEFT JOIN score ON student.id = score.student_id
GROUP BY student.id, student.name
HAVING COUNT(score.course_id) < (SELECT COUNT(DISTINCT course_id) FROM score)
```

